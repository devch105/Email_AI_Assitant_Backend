name: Ping Render health endpoint (every 5 minutes) - Quick

on:
  schedule:
    - cron: '*/5 * * * *'
  workflow_dispatch: {}

jobs:
  ping-health:
    runs-on: ubuntu-latest

    steps:
      - name: Ping health endpoint
        run: |
          HEALTH_URL="https://emailwriterai.onrender.com/check/health"
          echo "Calling $HEALTH_URL"
          curl --fail --show-error --retry 3 --retry-delay 5 --max-time 15 -sS "$HEALTH_URL" -o /tmp/health_response.txt \
          || (echo "Health ping failed"; cat /tmp/health_response.txt; exit 1)

          echo "Health ping success"
          echo "Response:"
          cat /tmp/health_response.txt
